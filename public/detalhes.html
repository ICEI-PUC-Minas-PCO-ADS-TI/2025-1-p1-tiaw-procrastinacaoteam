
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Página SIGN UP</title>
  <link rel="stylesheet" href="/css/styles.css">
  <script src="/js/index.js"></script>
</head>

    <body>
        <div class="titulo">
            <header>
            <h1 class="singup">SIGN UP</h1>
            <p>Procrastinar? Nunca mais!</p>
            <p>Para nós, o seu bem estar é o que importa.</p>
            <p>Por uma rotina produtiva!</p>
            <img src="/img/Imagem preguiça.png" alt="Logo" width="250" height="250">
            </header>

            <main class="formulario">
            <form id="cadastrologin">
                <h3><input class="lista" type="text" placeholder="Nome do usuário"><img src="/img/user.png" width="30" height="30"></h3>
                <h3><input class="lista" type="email" placeholder="E-mail"><img src="/img/email.png" width="30" height="30"></h3>
                <h3><input class="lista" type="password" placeholder="Defina sua senha"><img src="/img/lock.png" width="30" height="30"></h3>
                <h3><input class="lista" type="password" placeholder="Confirmar senha"><img src="/img/open-padlock.png" width="30" height="30"></h3>
            </form>
            </main>

            <button class="btn"><h3>Criar conta</h3></button>
            <button id="btn2">Já possuo conta</button>
        </div>

        <script>
            document.querySelector('.btn').addEventListener('click', async () => {
            const inputs = document.querySelectorAll('.lista');
            const nome = inputs[0].value.trim();
            const email = inputs[1].value.trim();
            const senha = inputs[2].value;
            const confirmarSenha = inputs[3].value;

        if (!nome || !email || !senha || !confirmarSenha) {
            alert('Por favor, preencha todos os campos.');
            return;
        }

        if (senha !== confirmarSenha) {
            alert('As senhas não coincidem. Tente novamente.');
            return;
        }

        try {
            const checar = await fetch(`http://localhost:3000/usuarios?login=${nome}`);
            const existentes = await checar.json();

            if (existentes.length > 0) {
                alert('Usuário já cadastrado. Escolha outro nome de usuário.');
                return;
            }

            const novoUsuario = {
                login: nome,
                email: email,
                senha: senha
            };

            const resposta = await fetch('http://localhost:3000/usuarios', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(novoUsuario)
            });

            if (resposta.ok) {
                const usuarioCriado = await resposta.json();
                sessionStorage.setItem('usuario', JSON.stringify(usuarioCriado));
                alert('Conta criada com sucesso!');
                window.location.href = 'index.html';
            } else {
                alert('Erro ao criar a conta. Tente novamente.');
            }
        } catch (erro) {
            console.error('Erro:', erro);
            alert('Erro ao conectar com o servidor.');
        }
        });

        document.getElementById('btn2').addEventListener('click', () => {
            window.location.href = 'login.html';
        });
        </script>
    </body>
</html>
